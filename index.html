<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>黄锡超 - 个人简历</title>
    <!-- TailwindCSS 3.0+ CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Heti CSS -->
    <link rel="stylesheet" href="//unpkg.com/heti/umd/heti.min.css" />
    <!-- 自定义样式 -->
    <script>
        // 设置Tailwind主题
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: "#f0f9ff",
                            100: "#e0f2fe",
                            200: "#bae6fd",
                            300: "#7dd3fc",
                            400: "#38bdf8",
                            500: "#0ea5e9",
                            600: "#0284c7",
                            700: "#0369a1",
                            800: "#075985",
                            900: "#0c4a6e",
                        },
                    },
                },
            },
            plugins: [],
        };

        // 检查系统主题偏好并设置初始主题
        if (
            localStorage.theme === "dark" ||
            (!("theme" in localStorage) &&
                window.matchMedia("(prefers-color-scheme: dark)").matches)
        ) {
            document.documentElement.classList.add("dark");
        } else {
            document.documentElement.classList.remove("dark");
        }

        // 缓存机制
        const starsCache = new Map();
        const CACHE_DURATION = 24 * 60 * 60 * 1000; // 1天缓存

        // 获取GitHub仓库stars数量的函数
        async function getGitHubStars(owner, repo) {
            const cacheKey = `${owner}/${repo}`;
            const cachedData = starsCache.get(cacheKey);

            if (
                cachedData &&
                Date.now() - cachedData.timestamp < CACHE_DURATION
            ) {
                console.log(`使用缓存数据: ${cacheKey}`);
                return cachedData.stars;
            }

            const maxRetries = 3;
            for (let i = 0; i < maxRetries; i++) {
                try {
                    console.log(
                        `尝试获取 ${owner}/${repo} 的 stars... (第${i + 1}次尝试)`,
                    );

                    // 使用 CORS 代理或直接调用
                    const apiUrl = `https://api.github.com/repos/${owner}/${repo}`;
                    const response = await fetch(apiUrl, {
                        method: "GET",
                        headers: {
                            Accept: "application/vnd.github.v3+json",
                            "User-Agent": "Resume-Website",
                        },
                        mode: "cors",
                        cache: "no-cache",
                    });

                    console.log(`API 响应状态: ${response.status}`);

                    if (!response.ok) {
                        if (response.status === 403) {
                            console.error("达到 GitHub API 速率限制");
                            return "速率受限";
                        }
                        if (response.status === 404) {
                            console.error(`仓库 ${owner}/${repo} 不存在`);
                            return 0;
                        }
                        throw new Error(
                            `HTTP error! status: ${response.status}`,
                        );
                    }

                    const data = await response.json();
                    const stars = data.stargazers_count || 0;

                    // 更新缓存
                    starsCache.set(cacheKey, {
                        stars,
                        timestamp: Date.now(),
                    });

                    console.log(
                        `成功获取 ${owner}/${repo} 的 stars: ${stars}`,
                    );
                    return stars;
                } catch (error) {
                    console.error(`第${i + 1}次尝试失败:`, error.message);
                    if (i === maxRetries - 1) {
                        // 如果有缓存数据，在失败时使用缓存
                        if (cachedData) {
                            console.log(`使用过期缓存数据: ${cacheKey}`);
                            return cachedData.stars;
                        }
                        // 直接返回速率受限信息
                        return "速率受限";
                    }
                    // 等待一段时间后重试
                    await new Promise((resolve) =>
                        setTimeout(resolve, 1000 * (i + 1)),
                    );
                }
            }
            return 0;
        }

        // 更新stars显示的函数
        async function updateStarsCount(element, owner, repo) {
            try {
                const stars = await getGitHubStars(owner, repo);
                element.innerHTML = `<i class="fa-solid fa-star mr-1"></i> ${stars} Stars`;
            } catch (error) {
                console.error(
                    `更新 ${owner}/${repo} 的 stars 显示时发生错误:`,
                    error,
                );
                element.innerHTML = `<i class="fa-solid fa-star mr-1"></i> 0 Stars`;
            }
        }
    </script>

    <style>
        /* 优化 Heti 排版造成的间距过大问题 */
        .heti p {
            margin-bottom: 0.1em;
            line-height: 1.5; /* 标准化行高 */
        }
        .heti li {
            line-height: 1.5;
            margin-bottom: 0;
        }
        .heti ul, .heti ol {
            margin-bottom: 0.1em;
        }

        /* 修复 Heti 与 Font Awesome 图标冲突，避免图标倾斜 */
        .fa,
        .fas,
        .far,
        .fal,
        .fab,
        .fa-solid,
        .fa-regular,
        .fa-light,
        .fa-brands,
        [class^="fa-"],
        [class*=" fa-"] {
            font-style: normal !important;
            text-decoration: none !important;
            transform: none !important;
        }

        i[class^="fa-"],
        i[class*=" fa-"] {
            font-style: normal !important;
        }

        /* 自定义样式 */
        input,
        textarea {
            background-color: white;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
        }

        .dark input,
        .dark textarea {
            background-color: #374151;
            border-color: #4b5563;
            color: white;
        }

        input:focus,
        textarea:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(14, 165, 233, 0.2);
            border-color: #0ea5e9;
        }

        section {
            transition:
                    opacity 0.5s ease,
                    transform 0.5s ease;
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .skill-card {
            transition: all 0.3s ease;
        }

        .skill-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .skill-card:hover .skill-icon {
            transform: scale(1.1);
            color: #0ea5e9;
        }

        .skill-icon {
            transition: all 0.3s ease;
        }

        .project-icon {
            transition: all 0.3s ease;
        }

        .card-hover:hover .project-icon {
            transform: scale(1.1);
            color: #0ea5e9;
        }

        /* --- 核心修复：图标对齐类 --- */
        .icon-align {
            height: 1.5em; /* 匹配文字行高 (Tailwind text-base 默认为 1.5rem/24px) */
            width: 1.5em;  /* 固定宽度，防止不同图标宽度不一导致错位 */
            display: inline-flex;
            align-items: center;     /* 垂直居中 */
            justify-content: center; /* 水平居中 */
            margin-right: 0.5rem;    /* 图标和文字的间距 */
            flex-shrink: 0;          /* 防止被压缩 */
            line-height: 1;
        }

        .icon-align > i,
        .icon-align > img {
            line-height: 1;
            font-style: normal !important;
        }
    </style>
</head>

<body
        class="antialiased bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-300"
>
<!-- 主题切换按钮 -->
<div class="fixed top-4 right-4 z-50">
    <button
            id="theme-toggle"
            class="p-2 rounded-full bg-white dark:bg-gray-800 shadow-md hover:shadow-lg transition-all duration-300 text-gray-800 dark:text-gray-200"
    >
        <i class="fa-solid fa-sun dark:hidden"></i>
        <i class="fa-solid fa-moon hidden dark:inline"></i>
    </button>
</div>

<!-- 导航栏 -->
<nav
        class="sticky top-0 bg-white/95 dark:bg-gray-800/95 backdrop-blur-md shadow-sm z-40 border-b border-gray-200 dark:border-gray-700"
>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
            <div class="flex items-center">
                <div
                        class="text-2xl font-bold text-primary-600 dark:text-primary-400"
                >
                    个人简历
                </div>
            </div>
            <div class="hidden md:flex items-center space-x-8">
                <a
                        href="#education"
                        class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200"
                >教育背景</a
                >
                <a
                        href="#skills"
                        class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200"
                >专业技能</a
                >
                <a
                        href="#work"
                        class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200"
                >工作经历</a
                >
                <a
                        href="#projects"
                        class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200"
                >项目经历</a
                >
                <a
                        href="#opensource"
                        class="text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200"
                >开源经历</a
                >
            </div>
            <div class="md:hidden flex items-center">
                <button
                        id="mobile-menu-button"
                        class="text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"
                >
                    <i class="fa-solid fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- 移动端菜单 -->
    <div
            id="mobile-menu"
            class="hidden md:hidden bg-white dark:bg-gray-800 shadow-md border-t border-gray-200 dark:border-gray-700"
    >
        <div class="pt-2 pb-4 space-y-1 px-4">
            <a
                    href="#education"
                    class="block py-2 text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"
            >教育背景</a
            >
            <a
                    href="#skills"
                    class="block py-2 text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"
            >专业技能</a
            >
            <a
                    href="#work"
                    class="block py-2 text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"
            >工作经历</a
            >
            <a
                    href="#projects"
                    class="block py-2 text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"
            >项目经历</a
            >
            <a
                    href="#opensource"
                    class="block py-2 text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400"
            >开源经历</a
            >
        </div>
    </div>
</nav>

<!-- 个人信息卡片 -->
<header class="max-w-7xl mx-auto my-8 px-4 sm:px-6 lg:px-8" id="profile-section">
    <div class="animate-pulse bg-white dark:bg-gray-800 h-64 rounded-2xl"></div>
</header>

<!-- 主要内容 -->
<main class="heti max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-24">
    <!-- 教育背景 -->
    <section id="education" class="mb-16 opacity-0 translate-y-4">
        <div class="flex items-center mb-6">
            <i
                    class="fa-solid fa-graduation-cap text-3xl text-primary-500 mr-4"
            ></i>
            <h2
                    class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white"
            >
                教育背景
            </h2>
        </div>
        <div id="education-content">
            <div class="animate-pulse bg-white dark:bg-gray-800 h-32 rounded-2xl"></div>
        </div>
    </section>

    <!-- 专业技能 -->
    <section id="skills" class="mb-16 opacity-0 translate-y-4">
        <div class="flex items-center mb-6">
            <i
                    class="fa-solid fa-code text-3xl text-primary-500 mr-4"
            ></i>
            <h2
                    class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white"
            >
                专业技能
            </h2>
        </div>
        <div id="skills-content" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="animate-pulse bg-white dark:bg-gray-800 h-40 rounded-2xl"></div>
            <div class="animate-pulse bg-white dark:bg-gray-800 h-40 rounded-2xl"></div>
        </div>
    </section>

    <!-- 工作经历 -->
    <section id="work" class="mb-8 opacity-0 translate-y-4">
        <div class="flex items-center mb-4">
            <i
                    class="fa-solid fa-briefcase text-3xl text-primary-500 mr-4"
            ></i>
            <h2
                    class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white"
            >
                工作经历
            </h2>
        </div>
        <div id="work-content">
            <div class="animate-pulse bg-white dark:bg-gray-800 h-64 rounded-2xl"></div>
        </div>
    </section>

    <!-- 项目经历 -->
    <section id="projects" class="mb-8 opacity-0 translate-y-4">
        <div class="flex items-center mb-4">
            <i
                    class="fa-solid fa-laptop-code text-3xl text-primary-500 mr-4"
            ></i>
            <h2
                    class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white"
            >
                项目经历
            </h2>
        </div>
        <div id="projects-content">
            <div class="animate-pulse bg-white dark:bg-gray-800 h-96 rounded-2xl"></div>
        </div>
    </section>

    <!-- 开源经历 -->
    <section id="opensource" class="mb-16 opacity-0 translate-y-4">
        <div class="flex items-center mb-6">
            <i
                    class="fa-solid fa-code-branch text-3xl text-primary-500 mr-4"
            ></i>
            <h2
                    class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white"
            >
                开源经历
            </h2>
        </div>
        <div id="opensource-content">
            <div class="animate-pulse bg-white dark:bg-gray-800 h-64 rounded-2xl"></div>
        </div>
    </section>
</main>

<!-- 页脚 -->
<footer
        class="bg-white dark:bg-gray-800 py-8 border-t border-gray-200 dark:border-gray-700"
>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div
                class="flex flex-col md:flex-row justify-between items-center"
        >
            <div class="mb-4 md:mb-0">
                <p
                        class="text-gray-600 dark:text-gray-400 font-medium flex items-center"
                >
                    <i class="fa-regular fa-copyright mr-1"></i>
                    <span>2025 HSn</span>
                </p>
                <p
                        class="text-sm text-gray-500 dark:text-gray-400 mt-1"
                >
                    使用 Tailwind CSS、Font Awesome 和 Heti 构建
                </p>
            </div>
            <div class="flex space-x-8" id="footer-contacts">
                <!-- Footer contacts will be loaded via JS -->
            </div>
        </div>
    </div>
</footer>

<!-- JavaScript -->
<script>
    // 主题切换
    const themeToggle = document.getElementById("theme-toggle");
    themeToggle.addEventListener("click", () => {
        if (document.documentElement.classList.contains("dark")) {
            document.documentElement.classList.remove("dark");
            localStorage.theme = "light";
        } else {
            document.documentElement.classList.add("dark");
            localStorage.theme = "dark";
        }
    });

    // 移动端菜单
    const mobileMenuButton =
        document.getElementById("mobile-menu-button");
    const mobileMenu = document.getElementById("mobile-menu");

    mobileMenuButton.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");
    });

    // 导航链接点击后关闭移动端菜单
    document.querySelectorAll("#mobile-menu a").forEach((link) => {
        link.addEventListener("click", () => {
            mobileMenu.classList.add("hidden");
        });
    });

    // Data Fetching and Rendering
    document.addEventListener("DOMContentLoaded", async () => {
        try {
            const response = await fetch('data.json');
            const data = await response.json();

            renderProfile(data.profile);
            renderEducation(data.education);
            renderSkills(data.skills);
            renderWork(data.workExperience);
            renderProjects(data.projects);
            renderOpenSource(data.openSource);
            renderFooter(data.profile.contacts);

            // Initialize Heti
            if (window.Heti) {
                const heti = new Heti(".heti");
                heti.autoSpacing();
            }

            // Initialize Star Fetching
            initStarFetching();

            // Initialize Scroll Animation
            initScrollAnimation();

        } catch (error) {
            console.error("Error loading data:", error);
        }
    });

    function renderProfile(profile) {
        const container = document.getElementById('profile-section');
        const contactsHtml = profile.contacts.map(c => `
                    <div class="flex items-center justify-center md:justify-start">
                        <span class="icon-align text-primary-500">
                            <i class="${c.icon}"></i>
                        </span>
                        ${c.link !== '#' ? `<a href="${c.link}" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline text-sm">${c.text}</a>` : `<span class="text-sm">${c.text}</span>`}
                    </div>
                `).join('');

        container.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow-xl rounded-2xl transition-all duration-300 hover:shadow-2xl card-hover">
                        <div class="p-6">
                            <div class="md:flex items-center">
                                <div class="flex-shrink-0 mb-6 md:mb-0">
                                    <div class="h-40 w-40 rounded-full overflow-hidden mx-auto md:mx-0 border-4 border-primary-100 dark:border-primary-900">
                                        <img src="${profile.avatar}" alt="${profile.name}的照片" class="h-full w-full object-cover" />
                                    </div>
                                </div>
                                <div class="md:ml-8 text-center md:text-left">
                                    <h1 class="text-3xl font-bold tracking-tight text-gray-900 dark:text-white">${profile.name}</h1>
                                    <p class="mt-2 text-xl text-gray-600 dark:text-gray-300">${profile.title}</p>
                                    <div class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-2">
                                        ${contactsHtml}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
    }

    function renderEducation(edu) {
        const container = document.getElementById('education-content');
        container.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-2xl p-6 transition-all duration-300 hover:shadow-lg card-hover">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 dark:text-white">${edu.school}</h3>
                                <p class="mt-1 text-gray-600 dark:text-gray-300">${edu.degree}</p>
                            </div>
                            <div class="mt-2 md:mt-0">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200">
                                    ${edu.period}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
    }

    function renderSkills(skills) {
        const container = document.getElementById('skills-content');
        container.innerHTML = skills.map(skill => `
                    <div class="skill-card bg-white dark:bg-gray-800 overflow-hidden shadow rounded-2xl p-6 transition-all duration-300 hover:shadow-lg border-l-4 border-primary-500">
                        <div class="flex items-center mb-4">
                            <i class="skill-icon ${skill.icon} text-3xl text-primary-500 mr-3"></i>
                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">${skill.category}</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300">${skill.description}</p>
                    </div>
                `).join('');
    }

    function renderWork(work) {
        const container = document.getElementById('work-content');
        container.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-2xl transition-all duration-300 hover:shadow-lg card-hover">
                        <div class="p-4 md:p-5">
                            ${work.map((job, index) => {
            // 修复：使用 icon-align 容器，并移除图标本身的 mr-2
            const itemsHtml = job.items.map(item => `
                                    <li class="flex items-start">
                                        <div class="icon-align">
                                            <i class="${item.icon} ${item.iconColor} project-icon"></i>
                                        </div>
                                        <p>${item.text}</p>
                                    </li>
                                `).join('');

            let html = `
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                                        <div>
                                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">${job.company}</h3>
                                            <p class="mt-1 text-gray-600 dark:text-gray-300">${job.role}</p>
                                        </div>
                                        <div class="mt-2 md:mt-0">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${job.periodClass}">
                                                ${job.period}
                                            </span>
                                        </div>
                                    </div>
                                    <ul class="mt-3 space-y-1 text-gray-600 dark:text-gray-300">
                                        ${itemsHtml}
                                    </ul>
                                `;

            if (index < work.length - 1) {
                html += `<hr class="my-2 border-gray-200 dark:border-gray-700" />`;
            }
            return html;
        }).join('')}
                        </div>
                    </div>
                `;
    }

    function renderProjects(projects) {
        const container = document.getElementById('projects-content');
        container.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-2xl transition-all duration-300 hover:shadow-lg card-hover">
                        <div class="p-4 md:p-5">
                             ${projects.map((project, index) => {
            // 修复：添加 icon-align 容器，移除 mr-2
            const highlightsHtml = project.highlights.map(h => `
                                    <li class="flex items-start">
                                        <div class="icon-align">
                                            <i class="${h.icon} ${h.iconColor} project-icon"></i>
                                        </div>
                                        <p>
                                            <span class="font-medium">${h.title}：</span>${h.text}
                                        </p>
                                    </li>
                                `).join('');

            let html = `
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                                        <div>
                                            <h3 class="text-xl font-bold text-gray-800 dark:text-white">${project.name}</h3>
                                            <p class="mt-1 text-gray-600 dark:text-gray-300">${project.role}</p>
                                        </div>
                                        <div class="mt-2 md:mt-0">
                                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${project.periodClass}">
                                                ${project.period}
                                            </span>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 dark:text-gray-300 mb-2">${project.description}</p>
                                    <div class="mb-2">
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">
                                            <strong>技术栈：</strong>${project.techStack}
                                        </p>
                                    </div>
                                    <p class="font-medium text-gray-700 dark:text-gray-300 mb-2">贡献亮点：</p>
                                    <ul class="mt-3 space-y-1 text-gray-600 dark:text-gray-300">
                                        ${highlightsHtml}
                                    </ul>
                                `;

            if (index < projects.length - 1) {
                html += `<hr class="my-4 border-gray-200 dark:border-gray-700" />`;
            }
            return html;
        }).join('')}
                        </div>
                    </div>
                `;
    }

    function renderOpenSource(os) {
        const container = document.getElementById('opensource-content');

        // Featured projects
        // 修复：添加 icon-align 容器
        const featuredHtml = os.featured.map(item => `
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-6 mb-6">
                        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                            <div class="flex items-center">
                                ${item.image
            ? `<span class="icon-align"><img src="${item.image}" alt="${item.title} Logo" class="w-full h-full object-contain" /></span>`
            : `<span class="icon-align"><i class="${item.mainIcon || item.icon} ${item.mainIconColor || item.iconColor} project-icon"></i></span>`
        }
                                <div>
                                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">${item.title}</h3>
                                    <a href="${item.link}" target="_blank" class="mt-1 text-primary-600 dark:text-primary-400 hover:underline">
                                        ${item.link.replace('https://', '')}
                                    </a>
                                </div>
                            </div>
                            <div class="mt-2 md:mt-0">
                                <span data-github-stars="${item.repo}" class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                    <i class="fa-solid fa-star mr-1"></i> Loading...
                                </span>
                            </div>
                        </div>
                        <ul class="mt-4 space-y-2 text-gray-600 dark:text-gray-300">
                            <li class="flex items-start">
                                <div class="icon-align">
                                    <i class="${item.itemIcon || 'fa-solid fa-cloud'} ${item.itemIconColor || 'text-blue-500'} project-icon"></i>
                                </div>
                                <p><span class="font-medium">项目概述：</span>${item.description}</p>
                            </li>
                        </ul>
                    </div>
                `).join('');

        // Other projects
        const othersHtml = os.others.map(item => `
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg card-hover">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="flex items-center mb-2">
                                    <span class="icon-align">
                                        <i class="${item.icon} ${item.iconColor} project-icon"></i>
                                    </span>
                                    <h4 class="font-bold">${item.title}</h4>
                                </div>
                                <a href="${item.link}" target="_blank" class="text-primary-600 dark:text-primary-400 hover:underline text-sm block mb-2">
                                    ${item.link.replace('https://', '')}
                                </a>
                                <p class="text-sm">${item.description}</p>
                            </div>
                            <span data-github-stars="${item.repo}" class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 whitespace-nowrap">
                                <i class="fa-solid fa-star mr-1"></i> Loading...
                            </span>
                        </div>
                    </div>
                `).join('');

        container.innerHTML = `
                    <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-2xl transition-all duration-300 hover:shadow-lg card-hover">
                        <div class="p-6">
                            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                                <div class="flex items-center">
                                    <span class="icon-align text-gray-700 dark:text-gray-300">
                                        <i class="${os.profile.icon} text-lg project-icon"></i>
                                    </span>
                                    <div>
                                        <h3 class="text-xl font-bold text-gray-800 dark:text-white">${os.profile.title}</h3>
                                        <a href="${os.profile.link}" target="_blank" class="mt-1 text-primary-600 dark:text-primary-400 hover:underline">
                                            ${os.profile.link.replace('https://', '')}
                                        </a>
                                        <p class="mt-2 text-gray-600 dark:text-gray-300">${os.profile.description}</p>
                                    </div>
                                </div>
                            </div>
                            
                            ${featuredHtml}
                            
                            <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">其他开源项目</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    ${othersHtml}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
    }

    function renderFooter(contacts) {
        const container = document.getElementById('footer-contacts');
        container.innerHTML = contacts.filter(c => c.icon.includes('envelope') || c.icon.includes('weixin') || c.icon.includes('github')).map(c => {
            // Special handling for weixin hover effect which is different from others
            if (c.icon.includes('weixin')) {
                return `
                            <a href="${c.link}" class="text-gray-500 hover:text-primary-500 transition-colors duration-200 transform hover:scale-110 group relative">
                                <i class="${c.icon} text-xl"></i>
                                <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 py-1 px-3 bg-gray-700 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap">
                                    微信: ${c.text}
                                </span>
                            </a>
                        `;
            }
            return `
                        <a href="${c.link}" ${c.link.startsWith('http') ? 'target="_blank"' : ''} class="text-gray-500 hover:text-primary-500 transition-colors duration-200 transform hover:scale-110">
                            <i class="${c.icon} text-xl"></i>
                        </a>
                     `;
        }).join('');
    }

    function initStarFetching() {
        console.log("开始获取所有仓库的 stars...");
        const starsElements = document.querySelectorAll("[data-github-stars]");
        const updatePromises = Array.from(starsElements).map(element => {
            const repoPath = element.getAttribute("data-github-stars");
            console.log(`处理仓库: ${repoPath}`);
            const [owner, repo] = repoPath.split("/");
            return updateStarsCount(element, owner, repo);
        });

        Promise.all(updatePromises)
            .then(() => { console.log("所有仓库的 stars 更新完成"); })
            .catch((error) => { console.error("更新 stars 时发生错误:", error); });
    }

    function initScrollAnimation() {
        const sections = document.querySelectorAll("section");
        const revealSection = (entries, observer) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    entry.target.classList.remove("opacity-0", "translate-y-4");
                    entry.target.classList.add("opacity-100", "translate-y-0", "transition-all", "duration-700", "ease-out");
                    observer.unobserve(entry.target);
                }
            });
        };

        const sectionObserver = new IntersectionObserver(revealSection, {
            root: null,
            threshold: 0.15,
        });

        sections.forEach((section) => {
            sectionObserver.observe(section);
        });

        // Check immediately
        setTimeout(() => {
            const visibleSections = Array.from(sections).filter((section) => {
                const rect = section.getBoundingClientRect();
                return (rect.top < window.innerHeight && rect.bottom >= 0);
            });
            visibleSections.forEach((section) => {
                section.classList.remove("opacity-0", "translate-y-4");
                section.classList.add("opacity-100", "translate-y-0", "transition-all", "duration-700", "ease-out");
                sectionObserver.unobserve(section);
            });
        }, 100);
    }
</script>

<!-- Heti JavaScript -->
<script src="//unpkg.com/heti/umd/heti-addon.min.js"></script>
</body>
</html>
